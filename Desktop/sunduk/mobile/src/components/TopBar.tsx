import React from 'react';
import {
  View,
  Text,
  StyleSheet,
  useWindowDimensions,
} from 'react-native';
import { LinearGradient } from 'expo-linear-gradient';
import Svg, { G, Path, Defs, ClipPath, Rect, RadialGradient, Stop } from 'react-native-svg';

interface TopBarProps {
  width?: number;
  height?: number;
  style?: any;
  // Statik veriler (şimdilik)
  language?: {
    code: string; // "EN"
  };
  challengeCount?: number; // 4
  diamondCount?: number; // 957
}

// Flag Icon Component (Frame (1).svg)
const FlagIcon: React.FC<{ size?: number }> = ({ size = 28 }) => (
  <Svg width={size} height={size} viewBox="0 0 28 28" fill="none">
    <G clipPath="url(#clip0_flag)">
      <Path d="M21 2.8875C18.9437 1.61875 16.5812 0.875 14 0.875V2.8875H21Z" fill="#ED4C5C" />
      <Path d="M14 4.89995H23.45C22.7062 4.1562 21.875 3.4562 21 2.88745H14V4.89995Z" fill="white" />
      <Path d="M14 6.91252H25.0687C24.5875 6.16877 24.0625 5.51252 23.4938 4.90002H14V6.91252Z" fill="#ED4C5C" />
      <Path d="M14 8.92498H26.1188C25.8125 8.22498 25.4625 7.52498 25.0687 6.91248H14V8.92498Z" fill="white" />
      <Path d="M14 10.9375H26.775C26.6 10.2375 26.3813 9.5813 26.1188 8.92505H14V10.9375Z" fill="#ED4C5C" />
      <Path d="M14 12.9937H27.0813C27.0375 12.2937 26.9063 11.6375 26.775 10.9812H14V12.9937Z" fill="white" />
      <Path d="M27.0813 12.9938H14V14H0.875C0.875 14.35 0.875 14.6563 0.91875 15.0063H27.0813C27.125 14.6563 27.125 14.35 27.125 14C27.125 13.65 27.125 13.3 27.0813 12.9938Z" fill="#ED4C5C" />
      <Path d="M1.2252 17.0187H26.7752C26.9502 16.3625 27.0377 15.7062 27.0814 15.0062H0.918945C0.962695 15.6625 1.0502 16.3625 1.2252 17.0187Z" fill="white" />
      <Path d="M1.88086 19.0313H26.1184C26.3809 18.375 26.5996 17.7188 26.7746 17.0188H1.22461C1.39961 17.7188 1.61836 18.375 1.88086 19.0313Z" fill="#ED4C5C" />
      <Path d="M2.93086 21.0437H25.0684C25.4621 20.3875 25.8121 19.7312 26.1184 19.0312H1.88086C2.18711 19.7312 2.53711 20.3875 2.93086 21.0437Z" fill="white" />
      <Path d="M4.50664 23.0562H23.4941C24.0629 22.4437 24.6316 21.7437 25.0691 21.0437H2.93164C3.36914 21.7875 3.93789 22.4437 4.50664 23.0562Z" fill="#ED4C5C" />
      <Path d="M6.95586 25.0688H21.0434C21.9621 24.5 22.7496 23.8 23.4934 23.0563H4.50586C5.24961 23.8438 6.08086 24.5 6.95586 25.0688Z" fill="white" />
      <Path d="M13.9998 27.125C16.5811 27.125 18.9873 26.3812 21.0436 25.0687H6.95605C9.0123 26.3812 11.4186 27.125 13.9998 27.125Z" fill="#ED4C5C" />
      <Path d="M7 2.8875C6.08125 3.45625 5.25 4.15625 4.50625 4.9C3.89375 5.5125 3.36875 6.2125 2.93125 6.9125C2.5375 7.56875 2.14375 8.225 1.88125 8.925C1.61875 9.58125 1.4 10.2375 1.225 10.9375C1.05 11.5938 0.9625 12.25 0.91875 12.95C0.875 13.3 0.875 13.65 0.875 14H14V0.875C11.4187 0.875 9.05625 1.61875 7 2.8875Z" fill="#428BC1" />
      <Path d="M10.9373 1.3125L11.1561 1.96875H11.8123L11.2873 2.40625L11.4623 3.0625L10.9373 2.66875L10.4123 3.0625L10.5873 2.40625L10.0623 1.96875H10.7186L10.9373 1.3125ZM12.6873 3.9375L12.9061 4.59375H13.5623L13.0373 5.03125L13.2123 5.6875L12.6873 5.29375L12.1623 5.6875L12.3373 5.03125L11.8123 4.59375H12.4686L12.6873 3.9375ZM9.1873 3.9375L9.40605 4.59375H10.0623L9.5373 5.03125L9.71231 5.6875L9.1873 5.29375L8.6623 5.6875L8.83731 5.03125L8.3123 4.59375H8.96855L9.1873 3.9375ZM10.9373 6.5625L11.1561 7.21875H11.8123L11.2873 7.65625L11.4623 8.3125L10.9373 7.91875L10.4123 8.3125L10.5873 7.65625L10.0623 7.21875H10.7186L10.9373 6.5625ZM7.4373 6.5625L7.65605 7.21875H8.3123L7.7873 7.65625L7.96231 8.3125L7.4373 7.91875L6.9123 8.3125L7.08731 7.65625L6.5623 7.21875H7.21855L7.4373 6.5625ZM3.9373 6.5625L4.15605 7.21875H4.8123L4.2873 7.65625L4.4623 8.3125L3.9373 7.91875L3.4123 8.3125L3.5873 7.65625L3.0623 7.21875H3.71855L3.9373 6.5625ZM12.6873 9.1875L12.9061 9.84375H13.5623L13.0373 10.2812L13.2123 10.9375L12.6873 10.5437L12.1623 10.9375L12.3373 10.2812L11.8123 9.84375H12.4686L12.6873 9.1875ZM9.1873 9.1875L9.40605 9.84375H10.0623L9.5373 10.2812L9.71231 10.9375L9.1873 10.5437L8.6623 10.9375L8.83731 10.2812L8.3123 9.84375H8.96855L9.1873 9.1875ZM5.6873 9.1875L5.90605 9.84375H6.5623L6.0373 10.2812L6.2123 10.9375L5.6873 10.5437L5.1623 10.9375L5.3373 10.2812L4.8123 9.84375H5.46855L5.6873 9.1875ZM10.9373 11.8125L11.1561 12.4688H11.8123L11.2873 12.9062L11.4623 13.5625L10.9373 13.1687L10.4123 13.5625L10.5873 12.9062L10.0623 12.4688H10.7186L10.9373 11.8125ZM7.4373 11.8125L7.65605 12.4688H8.3123L7.7873 12.9062L7.96231 13.5625L7.4373 13.1687L6.9123 13.5625L7.08731 12.9062L6.5623 12.4688H7.21855L7.4373 11.8125ZM3.9373 11.8125L4.15605 12.4688H4.8123L4.2873 12.9062L4.4623 13.5625L3.9373 13.1687L3.4123 13.5625L3.5873 12.9062L3.0623 12.4688H3.71855L3.9373 11.8125ZM5.1623 5.6875L5.6873 5.29375L6.2123 5.6875L5.99355 5.03125L6.51855 4.59375H5.8623L5.6873 3.9375L5.46855 4.59375H4.85605L5.38105 4.9875L5.1623 5.6875ZM1.6623 10.9375L2.1873 10.5437L2.7123 10.9375L2.49355 10.2812L3.01855 9.84375H2.40605L2.1873 9.1875L1.96855 9.84375H1.53105C1.53105 9.8875 1.4873 9.93125 1.4873 9.975L1.8373 10.2375L1.6623 10.9375Z" fill="white" />
    </G>
    <Defs>
      <ClipPath id="clip0_flag">
        <Rect width="28" height="28" fill="white" />
      </ClipPath>
    </Defs>
  </Svg>
);

// Challenge/Flame Icon Component (Group (2).svg)
const ChallengeIcon: React.FC<{ size?: number }> = ({ size = 21 }) => (
  <Svg width={size} height={27} viewBox="0 0 21 27" fill="none">
    <Path d="M4.07333 8.03509C3.94864 9.36509 3.86114 11.7188 4.64645 12.7207C4.64645 12.7207 4.27676 10.1351 7.59083 6.89103C8.9252 5.58509 9.23364 3.80884 8.7677 2.47666C8.50301 1.72197 8.01958 1.09853 7.59958 0.663218C7.35458 0.40728 7.5427 -0.0149073 7.89926 0.000405249C10.0561 0.0966553 13.5518 0.69603 15.0371 4.42353C15.6889 6.05978 15.7371 7.75072 15.4264 9.47009C15.2296 10.5682 14.5296 13.0095 16.1264 13.3092C17.2661 13.5235 17.8174 12.6179 18.0646 11.966C18.1674 11.6948 18.524 11.627 18.7164 11.8435C20.6414 14.0332 20.8055 16.6123 20.4074 18.8326C19.6374 23.1245 15.2908 26.2482 10.9727 26.2482C5.57833 26.2482 1.28426 23.1617 0.170825 17.5748C-0.277612 15.3195 -0.0501117 10.857 3.42801 7.70697C3.68614 7.47072 4.10833 7.68072 4.07333 8.03509Z" fill="url(#paint0_radial_challenge)" />
    <Path d="M12.9441 16.0615C10.9557 13.5021 11.846 10.5818 12.3338 9.41804C12.3994 9.26491 12.2244 9.12054 12.0866 9.2146C11.2313 9.79647 9.47913 11.1658 8.6632 13.093C7.55851 15.6983 7.63726 16.9737 8.29132 18.5312C8.68507 19.4696 8.22788 19.6687 7.9982 19.7037C7.77507 19.7387 7.56945 19.5899 7.40538 19.4346C6.9334 18.9815 6.59707 18.4058 6.43413 17.7721C6.39913 17.6365 6.22195 17.5993 6.14101 17.7108C5.52851 18.5574 5.21132 19.9158 5.19601 20.8762C5.14788 23.8446 7.60007 26.2508 10.5663 26.2508C14.3048 26.2508 17.0282 22.1165 14.8801 18.6602C14.2566 17.654 13.6704 16.9955 12.9441 16.0615Z" fill="url(#paint1_radial_challenge)" />
      <Defs>
      <RadialGradient id="paint0_radial_challenge" cx="0" cy="0" r="1" gradientTransform="matrix(-15.4409 -0.0670135 -0.110094 25.3354 9.90427 26.3162)" gradientUnits="userSpaceOnUse">
          <Stop offset="0.314" stopColor="#FF9800" />
          <Stop offset="0.662" stopColor="#FF6D00" />
          <Stop offset="0.972" stopColor="#F44336" />
        </RadialGradient>
      <RadialGradient id="paint1_radial_challenge" cx="0" cy="0" r="1" gradientTransform="matrix(-0.163184 16.1553 12.158 0.122792 10.7719 10.9511)" gradientUnits="userSpaceOnUse">
          <Stop offset="0.214" stopColor="#FFF176" />
          <Stop offset="0.328" stopColor="#FFF27D" />
          <Stop offset="0.487" stopColor="#FFF48F" />
          <Stop offset="0.672" stopColor="#FFF7AD" />
          <Stop offset="0.793" stopColor="#FFF9C4" />
          <Stop offset="0.822" stopColor="#FFF8BD" stopOpacity="0.804" />
          <Stop offset="0.863" stopColor="#FFF6AB" stopOpacity="0.529" />
          <Stop offset="0.91" stopColor="#FFF38D" stopOpacity="0.209" />
          <Stop offset="0.941" stopColor="#FFF176" stopOpacity="0" />
        </RadialGradient>
      </Defs>
  </Svg>
);

// Diamond Icon Component (Group (1).svg)
const DiamondIcon: React.FC<{ size?: number }> = ({ size = 27 }) => (
  <Svg width={size} height={size} viewBox="0 0 27 27" fill="none">
    <Path d="M13.125 0L24.4916 6.5625V19.6875L13.125 26.25L1.75842 19.6875V6.5625L13.125 0Z" fill="#1A96F0" />
    <Path d="M3.15039 7.48127L13.1254 1.83752V8.13752L8.92539 10.6313L3.15039 7.48127Z" fill="white" />
  </Svg>
);

// Star Icon Component (Group.svg)
const StarIcon: React.FC<{ size?: number }> = ({ size = 27 }) => (
  <Svg width={size} height={size} viewBox="0 0 27 27" fill="none">
    <Path d="M7.09967 7.02023L4.00655 5.03836C3.94419 5.00014 3.89131 4.94829 3.85186 4.8867C3.81242 4.8251 3.78744 4.75538 3.77881 4.68275C3.77018 4.61012 3.77812 4.53648 3.80203 4.46736C3.82594 4.39824 3.8652 4.33544 3.91686 4.28367L5.07842 3.12211C5.30155 2.89898 5.6778 2.94711 5.83749 3.22055L7.77124 6.36398C8.02499 6.79711 7.52842 7.28273 7.09967 7.02023ZM4.39592 16.5534L0.80405 16.6255C0.731014 16.6271 0.659286 16.6452 0.594254 16.6785C0.529223 16.7118 0.472579 16.7594 0.42858 16.8177C0.38458 16.876 0.354368 16.9435 0.340215 17.0152C0.326061 17.0869 0.328334 17.1608 0.346862 17.2315L0.764675 18.8196C0.845612 19.1259 1.19342 19.2724 1.46905 19.1193L4.64311 17.459C5.08061 17.2118 4.89905 16.5424 4.39592 16.5534ZM12.739 22.6543L11.9515 26.1521C11.8794 26.4562 12.109 26.7493 12.4219 26.7493H14.0647C14.3819 26.7493 14.6116 26.4496 14.5328 26.1434L13.6775 22.6455C13.5506 22.1577 12.8572 22.1643 12.739 22.6543ZM19.1484 7.02023L22.2416 5.03836C22.5084 4.8743 22.5522 4.50461 22.3312 4.28367L21.1697 3.12211C21.1173 3.06996 21.0537 3.0305 20.9837 3.00675C20.9138 2.983 20.8393 2.9756 20.766 2.9851C20.6927 2.9946 20.6226 3.02077 20.561 3.06158C20.4994 3.10239 20.4479 3.15677 20.4106 3.22055L18.4769 6.36398C18.2231 6.79711 18.7197 7.28273 19.1484 7.02023ZM21.8522 16.5534L25.444 16.6255C25.5171 16.6271 25.5888 16.6452 25.6538 16.6785C25.7189 16.7118 25.7755 16.7594 25.8195 16.8177C25.8635 16.876 25.8937 16.9435 25.9079 17.0152C25.922 17.0869 25.9198 17.1608 25.9012 17.2315L25.4834 18.8196C25.4645 18.891 25.4296 18.9571 25.3812 19.0129C25.3329 19.0687 25.2724 19.1127 25.2045 19.1416C25.1366 19.1706 25.0629 19.1836 24.9892 19.1797C24.9155 19.1758 24.8436 19.1552 24.779 19.1193L21.605 17.459C21.1675 17.2118 21.3491 16.5424 21.8522 16.5534Z" fill="#FFC107" />
    <Path d="M14.0106 0.549336L16.955 7.26496C17.0657 7.5177 17.2423 7.73608 17.4662 7.8973C17.6902 8.05852 17.9533 8.15668 18.2281 8.18152L25.4009 8.82465C26.2125 8.94277 26.5362 9.93809 25.9478 10.5112L20.5446 15.0503C20.1071 15.4178 19.9081 15.9953 20.0284 16.5531L21.599 23.9053C21.7368 24.7125 20.8903 25.3293 20.164 24.9465L13.9034 21.2803C13.6673 21.1417 13.3984 21.0686 13.1246 21.0686C12.8509 21.0686 12.582 21.1417 12.3459 21.2803L6.08527 24.9443C5.36121 25.325 4.51246 24.7103 4.65027 23.9031L6.2209 16.5509C6.33902 15.9931 6.14215 15.4156 5.70465 15.0481L0.299334 10.5134C-0.286916 9.94246 0.0368341 8.94496 0.846209 8.82684L8.01902 8.18371C8.29384 8.15887 8.55695 8.06071 8.78089 7.89949C9.00484 7.73827 9.1814 7.51989 9.29215 7.26715L12.2365 0.551524C12.6018 -0.183476 13.6475 -0.183476 14.0106 0.549336Z" fill="#FDD835" />
    <Path d="M13.7965 7.66732L13.2977 2.71919C13.278 2.44357 13.2212 1.97107 13.663 1.97107C14.013 1.97107 14.2033 2.69951 14.2033 2.69951L15.6996 6.67201C16.264 8.18357 16.0321 8.70201 15.4874 9.00826C14.8618 9.35826 13.9387 9.08482 13.7965 7.66732Z" fill="#FFFF8D" />
    <Path d="M19.9676 14.6103L24.2594 11.2612C24.4716 11.0841 24.8544 10.8019 24.5482 10.4803C24.3054 10.2266 23.6491 10.5919 23.6491 10.5919L19.8932 12.0597C18.7732 12.4469 18.0294 13.02 17.9638 13.7419C17.8785 14.7044 18.7426 15.4459 19.9676 14.6103Z" fill="#F4B400" />
  </Svg>
);

const TopBar: React.FC<TopBarProps> = ({
  width,
  height = 48,
  style,
  language = { code: 'EN' },
  challengeCount = 4,
  diamondCount = 957,
}) => {
  const { width: screenWidth } = useWindowDimensions();
  const barWidth = width || screenWidth;

  return (
    <LinearGradient
      colors={['#6949FF', '#876DFF']}
      start={{ x: 0, y: 0 }}
      end={{ x: 1, y: 0 }}
      style={[styles.container, { width: barWidth, height }, style]}
    >
      <View style={styles.content}>
        {/* Sol taraf: Flag + Language Code */}
        <View style={styles.leftSection}>
          <FlagIcon size={28} />
          <Text style={styles.languageText}>{language.code}</Text>
        </View>

        {/* Orta: Challenge Icon + Count */}
        <View style={styles.centerSection}>
          <ChallengeIcon size={21} />
          <Text style={styles.countText}>{challengeCount}</Text>
        </View>

        {/* Sağ taraf: Diamond Icon + Count + Star Icon */}
        {/* Ana section'lar arası gap: 16px (space-between ile otomatik) */}
        {/* Diamond ve Star arası gap: 16px */}
        <View style={styles.rightSection}>
          <View style={styles.diamondGroup}>
            <DiamondIcon size={24} />
            <Text style={styles.countText}>{diamondCount}</Text>
          </View>
          <View style={styles.sectionGap} />
          <StarIcon size={24} />
        </View>
      </View>
    </LinearGradient>
  );
};

const styles = StyleSheet.create({
  container: {
    justifyContent: 'center',
    alignItems: 'center',
  },
  content: {
    flexDirection: 'row',
    justifyContent: 'space-between',
    alignItems: 'center',
    paddingHorizontal: 24,
    paddingVertical: 12,
    width: '100%',
    height: '100%',
    minHeight: 48,
  },
  leftSection: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 8, // İkon ve metin arası gap: 8px
  },
  centerSection: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 8, // İkon ve metin arası gap: 8px
    marginHorizontal: 16, // Ana section'lar arası gap: 16px (sol ve sağ)
  },
  rightSection: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 8, // İkon ve metin arası gap: 8px
  },
  diamondGroup: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 8, // İkon ve metin arası gap: 8px
  },
  starGroup: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 8, // İkon ve metin arası gap: 8px
  },
  sectionGap: {
    width: 16, // Diamond ve Star arası gap: 16px
  },
  languageText: {
    fontSize: 14,
    fontWeight: '700',
    color: '#FFFFFF',
    fontFamily: 'System',
  },
  countText: {
    fontSize: 14,
    fontWeight: '700',
    color: '#FFFFFF',
    fontFamily: 'System',
  },
});

export default TopBar;
